{"ast":null,"code":"import { inject } from '@angular/core';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { UploadService } from './upload.service';\nimport { firstValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nconst _c0 = [\"uploadFile\"];\nconst _c1 = [\"imageKey\"];\nfunction AppComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"img\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_ng_template_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \" No image\\n\");\n  }\n}\nclass AppComponent {\n  constructor() {\n    this.picture = '';\n    this.fb = inject(FormBuilder);\n    this.uploadSvc = inject(UploadService);\n  }\n  ngOnInit() {\n    this.form = this.fb.group({\n      title: this.fb.control('', [Validators.required]),\n      file: this.fb.control(null, [Validators.required])\n    });\n  }\n  upload() {\n    const f = this.uploadFile.nativeElement.files[0];\n    const data = this.form.value;\n    console.info('data: ', data);\n    console.info('file: ', f);\n    firstValueFrom(this.uploadSvc.upload(data['title'], f)).then(result => {\n      alert('uploaded');\n      this.form.reset();\n    }).catch(err => {\n      alert(JSON.stringify(err));\n    });\n  }\n  getImage() {\n    const key = this.imageKey.nativeElement.value;\n    this.uploadSvc.getImage(key).subscribe(value => {\n      this.createImage(value);\n    });\n  }\n  createImage(image) {\n    if (image && image.size > 0) {\n      let reader = new FileReader();\n      reader.onload = e => this.picture = e.target?.result;\n      reader.readAsDataURL(image);\n    }\n  }\n}\nAppComponent.ɵfac = function AppComponent_Factory(t) {\n  return new (t || AppComponent)();\n};\nAppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AppComponent,\n  selectors: [[\"app-root\"]],\n  viewQuery: function AppComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n      i0.ɵɵviewQuery(_c1, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.uploadFile = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.imageKey = _t.first);\n    }\n  },\n  decls: 38,\n  vars: 4,\n  consts: [[3, \"formGroup\", \"submit\"], [\"type\", \"text\", \"size\", \"30\", \"formControlName\", \"title\"], [\"type\", \"file\", \"formControlName\", \"file\"], [\"uploadFile\", \"\"], [\"type\", \"submit\", 3, \"disabled\"], [\"type\", \"text\", \"size\", \"30\"], [\"imageKey\", \"\"], [\"type\", \"button\", 3, \"click\"], [4, \"ngIf\", \"ngIfElse\"], [\"noImage\", \"\"]],\n  template: function AppComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\");\n      i0.ɵɵtext(1, \"Upload\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"form\", 0);\n      i0.ɵɵlistener(\"submit\", function AppComponent_Template_form_submit_2_listener() {\n        return ctx.upload();\n      });\n      i0.ɵɵelementStart(3, \"table\")(4, \"tr\")(5, \"td\");\n      i0.ɵɵtext(6, \"Title:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"td\");\n      i0.ɵɵelement(8, \"input\", 1);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(9, \"tr\")(10, \"td\");\n      i0.ɵɵtext(11, \"File:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"td\");\n      i0.ɵɵelement(13, \"input\", 2, 3);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(15, \"tr\");\n      i0.ɵɵelement(16, \"td\");\n      i0.ɵɵelementStart(17, \"td\")(18, \"button\", 4);\n      i0.ɵɵtext(19, \"Upload\");\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelement(20, \"br\")(21, \"br\");\n      i0.ɵɵelementStart(22, \"table\")(23, \"tr\")(24, \"td\");\n      i0.ɵɵtext(25, \"Key:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"td\");\n      i0.ɵɵelement(27, \"input\", 5, 6);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(29, \"tr\");\n      i0.ɵɵelement(30, \"td\");\n      i0.ɵɵelementStart(31, \"td\")(32, \"button\", 7);\n      i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_32_listener() {\n        return ctx.getImage();\n      });\n      i0.ɵɵtext(33, \"get image\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelement(34, \"br\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(35, AppComponent_div_35_Template, 2, 0, \"div\", 8);\n      i0.ɵɵtemplate(36, AppComponent_ng_template_36_Template, 1, 0, \"ng-template\", null, 9, i0.ɵɵtemplateRefExtractor);\n    }\n    if (rf & 2) {\n      const _r3 = i0.ɵɵreference(37);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"formGroup\", ctx.form);\n      i0.ɵɵadvance(16);\n      i0.ɵɵproperty(\"disabled\", ctx.form.invalid);\n      i0.ɵɵadvance(17);\n      i0.ɵɵproperty(\"ngIf\", ctx.image)(\"ngIfElse\", _r3);\n    }\n  },\n  dependencies: [i1.NgIf, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});\nexport { AppComponent };","map":{"version":3,"names":["inject","FormBuilder","Validators","UploadService","firstValueFrom","i0","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","ɵɵtext","AppComponent","constructor","picture","fb","uploadSvc","ngOnInit","form","group","title","control","required","file","upload","f","uploadFile","nativeElement","files","data","value","console","info","then","result","alert","reset","catch","err","JSON","stringify","getImage","key","imageKey","subscribe","createImage","image","size","reader","FileReader","onload","e","target","readAsDataURL","selectors","viewQuery","AppComponent_Query","rf","ctx","ɵɵlistener","AppComponent_Template_form_submit_2_listener","AppComponent_Template_button_click_32_listener","ɵɵtemplate","AppComponent_div_35_Template","AppComponent_ng_template_36_Template","ɵɵtemplateRefExtractor","ɵɵadvance","ɵɵproperty","invalid","_r3"],"sources":["C:\\Users\\super\\OneDrive\\Desktop\\day38\\client\\src\\app\\app.component.ts","C:\\Users\\super\\OneDrive\\Desktop\\day38\\client\\src\\app\\app.component.html"],"sourcesContent":["import { Component, ElementRef, OnInit, ViewChild, inject } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { UploadService } from './upload.service';\nimport { Observable, firstValueFrom } from 'rxjs';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit{\n  @ViewChild('uploadFile')\n  uploadFile!: ElementRef\n  @ViewChild('imageKey')\n  imageKey!: ElementRef\n\n \n  picture = ''\n \n  form!: FormGroup\n  fb = inject(FormBuilder)\n  uploadSvc = inject(UploadService)\n\n  ngOnInit(): void {\n      this.form = this.fb.group({\n        title: this.fb.control<string>('', [Validators.required]),\n        file: this.fb.control<File | null>(null, [Validators.required])\n      })\n  }\n\n  upload() {\n    const f: File = this.uploadFile.nativeElement.files[0]\n    const data = this.form.value\n    console.info('data: ', data)\n    console.info('file: ', f)\n\n    firstValueFrom(this.uploadSvc.upload(data['title'], f))\n    .then(result => {\n      alert('uploaded')\n      this.form.reset()\n    })\n    .catch(err => {\n      alert(JSON.stringify(err))\n    })\n  }\n\n  getImage() {\n    const key = this.imageKey.nativeElement.value\n    this.uploadSvc.getImage(key).subscribe(\n      value => {\n        this.createImage(value);\n      }\n      \n    )\n  }\n\n  private createImage(image: Blob) {\n    if (image && image.size > 0) {\n      let reader = new FileReader();\n      reader.onload = (e) => this.picture = e.target?.result;\n      reader.readAsDataURL(image);\n    }\n  }\n}\n","<h1>Upload</h1>\n\n<form [formGroup]=\"form\" (submit)=\"upload()\">\n  <table>\n    <tr>\n      <td>Title:</td>\n      <td>\n        <input type=\"text\" size=\"30\" formControlName=\"title\">\n      </td>\n    </tr>\n    <tr>\n      <td>File:</td>\n      <td>\n        <input type=\"file\" formControlName=\"file\" #uploadFile>\n      </td>\n    </tr>\n    <tr>\n      <td></td>\n      <td>\n        <button type=\"submit\" [disabled]=\"form.invalid\">Upload</button>\n      </td>\n    </tr>\n  </table>\n</form>\n\n<br>\n<br>\n<table>\n  <tr>\n    <td>Key:</td>\n    <td>\n      <input type=\"text\" size=\"30\" #imageKey>\n    </td>\n  </tr>\n  <tr>\n    <td></td>\n    <td>\n      <button type=\"button\" (click)=\"getImage()\">get image</button>\n    </td>\n  </tr>\n  <br>\n</table>\n\n\n<div *ngIf=\"image; else noImage\">\n  <img >\n</div>\n<ng-template #noImage>\n  No image\n</ng-template>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}