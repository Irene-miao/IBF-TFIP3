{"ast":null,"code":"import { inject } from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport { CartService } from '../cart.service';\nimport { Router } from '@angular/router';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/router\";\nfunction CartComponent_div_21_tr_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 10)(1, \"td\");\n    i0.ɵɵelement(2, \"input\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\")(4, \"select\", 12)(5, \"option\", 13);\n    i0.ɵɵtext(6, \"1\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"option\", 14);\n    i0.ɵɵtext(8, \"2\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"option\", 15);\n    i0.ɵɵtext(10, \"3\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"option\", 16);\n    i0.ɵɵtext(12, \"4\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"option\", 17);\n    i0.ɵɵtext(14, \"5\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(15, \"td\")(16, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function CartComponent_div_21_tr_9_Template_button_click_16_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const i_r5 = restoredCtx.index;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.removeItem(i_r5));\n    });\n    i0.ɵɵtext(17, \"delete\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const i_r5 = ctx.index;\n    i0.ɵɵproperty(\"formGroupName\", i_r5);\n  }\n}\nfunction CartComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"table\")(2, \"thead\")(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5, \"Item\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"Quantity\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(8, \"tbody\", 8);\n    i0.ɵɵtemplate(9, CartComponent_div_21_tr_9_Template, 18, 1, \"tr\", 9);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(9);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.itemArr.controls);\n  }\n}\nfunction CartComponent_ng_template_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtext(1, \"Your cart is empty\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function () {\n  return [\"/list\"];\n};\nlet CartComponent = /*#__PURE__*/(() => {\n  class CartComponent {\n    constructor() {\n      // Cart  Form\n      this.title = inject(Title);\n      this.cartSvc = inject(CartService);\n      this.router = inject(Router);\n      this.fb = inject(FormBuilder);\n    }\n    ngOnInit() {\n      this.title.setTitle(`Cart: ${this.cartSvc.username}`);\n      this.createForm();\n    }\n    canExit() {\n      return !this.form.dirty;\n    }\n    getMessage() {\n      return \"You have not saved your cart.\\nAre you sure you want to leave?\";\n    }\n    saveCart() {\n      const cart = this.form.value;\n      console.info('cart:', cart);\n      this.cartSvc.saveCart(cart).then(result => {\n        console.info('saved to db:', result);\n        // clear form\n        this.createForm();\n        this.router.navigate(['/list']);\n      }).catch(error => {\n        console.error('error:', error);\n      });\n    }\n    addItem() {\n      this.itemArr.push(this.createItem());\n    }\n    removeItem(i) {\n      this.itemArr.removeAt(i);\n    }\n    createForm() {\n      return this.fb.group({\n        item: this.fb.control('', [Validators.required])\n      });\n    }\n    createItem() {\n      return this.fb.group({\n        item: this.fb.control('', [Validators.required]),\n        quantity: this.fb.control(1, [Validators.required, Validators.min(1)])\n      });\n    }\n    invalid() {\n      return this.form.invalid || this.itemArr.length <= 0;\n    }\n  }\n  CartComponent.ɵfac = function CartComponent_Factory(t) {\n    return new (t || CartComponent)();\n  };\n  CartComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CartComponent,\n    selectors: [[\"app-cart\"]],\n    decls: 26,\n    vars: 6,\n    consts: [[3, \"formGroup\", \"submit\"], [\"type\", \"text\", \"size\", \"30\", \"formControlName\", \"title\"], [\"cols\", \"30\", \"rows\", \"5\", \"formControlName\", \"comments\"], [\"type\", \"submit\", 3, \"disabled\"], [\"type\", \"button\", 3, \"click\"], [4, \"ngIf\", \"ngIfElse\"], [\"type\", \"button\", 3, \"routerLink\"], [\"emptyCart\", \"\"], [\"formArrayName\", \"items\"], [3, \"formGroupName\", 4, \"ngFor\", \"ngForOf\"], [3, \"formGroupName\"], [\"type\", \"text\", \"size\", \"30\", \"formControlName\", \"item\"], [\"formGroupName\", \"quantity\"], [\"value\", \"1\"], [\"value\", \"2\"], [\"value\", \"3\"], [\"value\", \"4\"], [\"value\", \"5\"]],\n    template: function CartComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\");\n        i0.ɵɵtext(1, \"Shopping Cart\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"form\", 0);\n        i0.ɵɵlistener(\"submit\", function CartComponent_Template_form_submit_2_listener() {\n          return ctx.saveCart();\n        });\n        i0.ɵɵelementStart(3, \"table\")(4, \"tr\")(5, \"td\");\n        i0.ɵɵtext(6, \"Title:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"td\");\n        i0.ɵɵelement(8, \"input\", 1);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"tr\")(10, \"td\");\n        i0.ɵɵtext(11, \"Comments:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"td\");\n        i0.ɵɵelement(13, \"textarea\", 2);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"tr\");\n        i0.ɵɵelement(15, \"td\");\n        i0.ɵɵelementStart(16, \"td\")(17, \"button\", 3);\n        i0.ɵɵtext(18, \"Save\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function CartComponent_Template_button_click_19_listener() {\n          return ctx.addItem();\n        });\n        i0.ɵɵtext(20, \"Add item\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵtemplate(21, CartComponent_div_21_Template, 10, 1, \"div\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"button\", 6);\n        i0.ɵɵtext(23, \"Cancel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(24, CartComponent_ng_template_24_Template, 2, 0, \"ng-template\", null, 7, i0.ɵɵtemplateRefExtractor);\n      }\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(25);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"formGroup\", ctx.form);\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"disabled\", ctx.invalid());\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.itemArr.length > 0)(\"ngIfElse\", _r1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(5, _c0));\n      }\n    },\n    dependencies: [i1.NgForOf, i1.NgIf, i2.ɵNgNoValidate, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName, i2.FormGroupName, i2.FormArrayName, i3.RouterLink]\n  });\n  return CartComponent;\n})();\nexport { CartComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}